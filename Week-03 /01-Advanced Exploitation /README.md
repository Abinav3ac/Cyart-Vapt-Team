## Advanced Exploitation Lab
Activities
# Tools

Metasploit Framework – for reliable exploitation and payload handling

Burp Suite – for session hijacking and request manipulation

Exploit-DB – for studying public exploit logic and proof-of-concepts

Python – for understanding and customizing exploit PoCs (analysis level)

# Tasks

Perform exploit chaining by combining multiple vulnerabilities

Demonstrate transition from web-layer vulnerability to system-level compromise

Analyze and customize public exploit logic for real targets

Document exploitation flow with clear technical evidence

# Brief
Exploit Chain Overview

In this lab, a multi-stage exploit chain was successfully executed against a Metasploitable2 virtual machine.
The attack began with a client-side web vulnerability (Reflected XSS) and escalated into full remote code execution (RCE) with root privileges using Metasploit.

The exploit chain demonstrates how low-to-medium severity web vulnerabilities, when combined with weak session management and vulnerable services, can lead to complete system compromise.

# Exploit Chain Execution
# Stage 1 – Reflected XSS (Initial Access)

A reflected Cross-Site Scripting (XSS) vulnerability was identified in the DVWA application.

User input was reflected back to the browser without sanitization or output encoding.

A JavaScript payload was injected to extract session cookies.

Payload used:

<script>alert(document.cookie)</script>

# Result:

Application session cookie (PHPSESSID) was exposed.

This confirmed that the application does not enforce:

HttpOnly cookie flag

Secure session handling

# Stage 2 – Session Hijacking (Privilege Abuse)

The stolen session cookie was injected into a valid HTTP request using Burp Suite Repeater.

The server accepted the attacker-controlled session without re-authentication.

# Impact:

Unauthorized access to authenticated resources

Successful session impersonation

This stage converts a client-side vulnerability into a server-side trust failure.

# Stage 3 – Remote Code Execution (System Compromise)

After gaining authenticated context, service enumeration results from Nmap were leveraged.

The target exposed multiple outdated and vulnerable services.
One of these was vsftpd 2.3.4, which contains a known backdoor vulnerability.

Using Metasploit:

A backdoor was triggered

A remote shell was spawned

Root access was obtained immediately

This completed the exploit chain:

XSS → Session Hijacking → Service Exploitation → Root RCE

Exploit Log
| Exploit ID | Description                | Target IP      | Status  | Payload / Access |
| ---------- | -------------------------- | -------------- | ------- | ---------------- |
| 004        | XSS → Session Hijack → RCE | 192.168.56.101 | Success | Root Shell       |

# Customization of Exploit PoC (Exploit-DB)

Although Metasploit was used for reliable exploitation, Exploit-DB PoCs were analyzed to understand how real-world exploits are customized.

Customization Focus

Hardcoded target IPs were replaced with variables

Service ports were parameterized

Payload execution paths were reviewed for compatibility

Unnecessary debug output was removed for stealth

# Customization Matters

Public exploits are rarely plug-and-play in real environments.
Attackers and testers must adapt PoCs to:

Network layouts

Service versions

Target OS behavior

This skill is critical for advanced exploitation scenarios.

# Findings

Reflected XSS allowed session token theft

Weak session management enabled session hijacking

Outdated FTP service allowed unauthenticated root access

Lack of defense-in-depth allowed full exploit chaining

Affected Host: 192.168.56.101

# Impact Assessment

Confidentiality: Compromised (credential and data exposure)

Integrity: Compromised (root-level access)

Availability: At risk (system services fully controllable)

This represents a critical security failure.

# Remediation Recommendations

Sanitize and encode all user input

Implement HttpOnly and Secure flags on session cookies
